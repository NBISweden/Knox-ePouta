%% ================================
%% TikZ styles
%% ================================

\pgfdeclarelayer{my background} 
\pgfsetlayers{background,my background,main}

\tikzset{background rectangle/.style={rounded corners=1ex,draw=gray!5,thick,fill=gray!10,double}} % inner sep=1pt,bottom color=red!20,top color=white

%------------------------------------------

\tikzset{vm/.style={%
drop shadow,
rounded corners=0.5ex,thin,inner xsep=2pt,inner ysep=1ex,
rectangle split,rectangle split parts=2,
every two node part/.style={font=\tiny},
text width=12ex,align=center,
top color=blue!30,bottom color=blue!30,middle color=blue!10
}}

\tikzset{link/.style={%
fill=white,
draw=black,double,
inner xsep=4ex,rounded corners=1ex
}}
\tikzset{connector/.style={draw,circle,fill=white,inner sep=0pt,minimum size=3pt}}

\tikzset{nodename/.style={
draw,double,fill=white,rounded corners=0.5ex,
inner xsep=1ex,inner ysep=0.5ex,
anchor=center
}}

\makeatletter
\pgfdeclareshape{out-interface-shape}{
  \inheritsavedanchors[from=rectangle] % this is nearly a rectangle
  \inheritanchorborder[from=rectangle]
  \inheritanchor[from=rectangle]{center}
  \inheritanchor[from=rectangle]{north}
  \inheritanchor[from=rectangle]{south}
  \inheritanchor[from=rectangle]{west}
  \inheritanchor[from=rectangle]{east}
  \inheritanchor[from=rectangle]{south west}
  \inheritanchor[from=rectangle]{south east}
  \inheritanchor[from=rectangle]{north east}
  \inheritanchor[from=rectangle]{north west}
  \backgroundpath{% this is new
    % store lower right in xa/ya and upper right in xb/yb
    \southwest \pgf@xa=\pgf@x \pgf@ya=\pgf@y
    \northeast \pgf@xb=\pgf@x \pgf@yb=\pgf@y
    % construct main path
    \pgfsetcornersarced{\pgfpoint{0.5ex}{0.5ex}}
    \pgfpathmoveto{\pgfpoint{\pgf@xa}{\pgf@ya}}
    \pgfpathlineto{\pgfpoint{\pgf@xa}{\pgf@yb}}
    \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@yb}}
    \pgfsetcornersarced{\pgfpoint{0pt}{0pt}}
    \pgfpathlineto{\pgfpoint{\pgf@xb}{\pgf@ya}}
    \pgfpathclose
 }
}
\makeatother

\tikzset{vlan-interface/.style={ rounded corners=0.5ex,%draw,
fill=blue!30,inner xsep=1ex,inner ysep=1ex,anchor=center,shape=rectangle,
}}

\tikzset{out-interface/.style={rounded corners=0.5ex,
fill=blue!30,inner xsep=1ex,inner ysep=1ex,anchor=center,shape=out-interface-shape,
}}



%------------------------------------------
%% Non atomic
\tikzset{looplabel/.style={scale=0.7,inner xsep=2pt,draw=gray!10,fill=white,rounded corners=2pt,anchor=center}}
 

%------------------------------------------

\tikzset{enumbullet/.style={draw,circle,double,inner sep=1pt}}
\tikzset{challenge/.style={draw,circle,double,scale=0.75,inner sep=1pt}}
\tikzset{subchallenge/.style={circle,fill=white,scale=0.6,inner sep=0.5pt,draw=black,very thin}}

\tikzset{myedge/.style={draw,shorten >=1pt,>=stealth',semithick}}
\tikzset{process/.style={circle,minimum width=2ex,inner sep=1pt,draw=blue!50,fill=blue!20,thick}}
\tikzset{mylabel/.style={inner xsep=2pt,draw=gray!10,fill=white,double,rounded corners=2pt,anchor=center}}
\tikzset{separation/.style={white,semithick}}

\tikzset{context/.style={rectangle,minimum width=3.2ex,minimum height=3.2ex,inner sep=0pt,fill=none,draw=black,thin,scale=0.6,anchor=center,fill=yellow!20!white}}
\tikzset{project/.style={draw,shorten >=1pt,>=stealth',very thin,blue!70!red}}
\tikzset{context-matrix/.style={matrix of nodes,inner xsep=0pt,column sep=1.5pt,column 1/.style={anchor=base}}}
%\tikzset{na-looplabel/.style={inner sep=2pt,draw=gray,fill=white,rounded corners=2pt,anchor=base,yshift=-2pt}}
